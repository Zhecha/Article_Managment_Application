{"ast":null,"code":"var _jsxFileName = \"/media/user/HDD/taskList/client/src/components/ArticleComments.js\";\nimport React from 'react';\nimport * as route from '../constants/routes';\nimport withNoUser from './withNoUser';\nimport { connect } from 'react-redux';\nimport * as func from '../functions/functions';\nimport Header from './Header';\nimport { getArticle } from '../redux/actions/ArticleActions';\nimport { token } from './Token';\nimport Masonry from 'react-masonry-component';\nimport { updateField, updateDisabled, createComment, getComments, updateComment } from '../redux/actions/CommentActions';\nimport * as urls from '../constants/urls';\nimport Comment from './Comment';\nimport io from 'socket.io-client';\n\nclass ArticleCommetns extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleChangeField = this.handleChangeField.bind(this);\n    this.handleCreateComment = this.handleCreateComment.bind(this);\n    this.handleBack = this.handleBack.bind(this);\n  }\n\n  handleBack() {\n    if (this.props.location.search.length) {\n      const query = func.queryParse(this.props.location.search);\n\n      if (!query.page) {\n        if (!query.limit) {\n          this.props.history.push(route.pageArticleRouteSort(query.sort, query.by));\n        } else {\n          if (!query.sort) {\n            this.props.history.push(route.pageArticleRouteLimit(query.limit));\n          } else {\n            this.props.history.push(route.pageArticleLimitRouteWithSort(query.limit, query.sort, query.by));\n          }\n        }\n      } else {\n        if (!query.sort) {\n          this.props.history.push(route.pageArticleRoute(query.page, query.limit));\n        } else {\n          this.props.history.push(route.pageArticleRouteWithSort(query.page, query.limit, query.sort, query.by));\n        }\n      }\n    } else {\n      this.props.history.push(route.ARTICLE_LIST);\n    }\n  }\n\n  async handleCreateComment() {\n    try {\n      const gettedToken = token.getToken();\n      const comment = {\n        id: this.props.match.params.id,\n        text: this.props.commentText,\n        creator: this.props.user.id\n      };\n      await this.props.createComment(urls.URL_COMMENT, gettedToken, comment);\n      this.props.updateDisabled(true);\n    } catch (error) {\n      if (error.isInvalidToken) {\n        token.logout();\n        this.props.history.push(route.SIGN_IN);\n      } else {\n        console.log(error);\n      }\n    }\n  }\n\n  handleChangeField(event) {\n    this.props.updateDisabled(false);\n    this.props.updateField(event.target.value);\n  }\n\n  async componentDidMount() {\n    try {\n      const socket = io(urls.URL_ROOT);\n      const gettedToken = token.getToken();\n      socket.emit('auth', {\n        id: this.props.user.id\n      });\n      socket.on('getNewComment', comment => {\n        if (this.props.match.params.id === comment.id_article) {\n          this.props.updateComment(comment);\n        }\n      });\n      await this.props.getArticle(gettedToken, this.props.match.params.id);\n      await this.props.getComments(urls.urlArticleComments(this.props.match.params.id), gettedToken);\n      this.props.updateDisabled(true);\n    } catch (error) {\n      if (error.isInvalidToken) {\n        token.logout();\n        this.props.history.push(route.SIGN_IN);\n      } else {\n        console.log(error);\n      }\n    }\n  }\n\n  render() {\n    const masonryOptions = {\n      itemSelector: '.grid-item',\n      breakpointCols: 3,\n      columnWidth: 300,\n      gutter: 10,\n      isFitWidth: true\n    };\n    const isError = !!this.props.error;\n    const viewError = isError ? React.createElement(\"h6\", {\n      style: {\n        color: 'red'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, this.props.error) : null;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Header, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"btn btn-outline-dark\",\n      type: \"button\",\n      onClick: this.handleBack,\n      style: {\n        float: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, \"Back\"), React.createElement(\"div\", {\n      className: \"container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col-sm-9 col-md-7 col-lg-5 mx-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card card-signin my-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"card-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"h5\", {\n      className: \"card-title text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, \"CommentArticle\"), React.createElement(\"form\", {\n      className: \"form-signin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"form-label-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"inputTitle\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \"Title\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"inputTitle\",\n      className: \"form-control\",\n      placeholder: \"title\",\n      name: \"title\",\n      value: this.props.article.title,\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"form-label-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"inputBody\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }, \"Body\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"inputBody\",\n      className: \"form-control\",\n      placeholder: \"body\",\n      name: \"body\",\n      value: this.props.article.body,\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"form-label-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"inputDateCreated\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, \"DateCreated\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"inputDateCreated\",\n      className: \"form-control\",\n      placeholder: \"dateCreated\",\n      name: \"dateCreated\",\n      value: this.props.article.dateCreated,\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"form-label-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"inputDateUpdated\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"DateUpdated\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"inputDateUpdated\",\n      className: \"form-control\",\n      placeholder: \"dateUpdated\",\n      name: \"dateUpdated\",\n      value: this.props.article.dateUpdated,\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    })), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), viewError, React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }), React.createElement(\"hr\", {\n      className: \"my-4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-outline-info\",\n      type: \"button\",\n      \"data-toggle\": \"collapse\",\n      \"data-target\": \"#Comment\",\n      \"aria-expanded\": \"false\",\n      \"aria-controls\": \"Comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, \"Comment\"), React.createElement(\"button\", {\n      className: \"btn btn-outline-success\",\n      type: \"button\",\n      style: {\n        float: 'right'\n      },\n      \"data-toggle\": \"collapse\",\n      \"data-target\": \"#Comment\",\n      \"aria-expanded\": \"false\",\n      \"aria-controls\": \"Comment\",\n      disabled: this.props.isDisabled,\n      onClick: this.handleCreateComment,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, \"AddComment\")), React.createElement(\"div\", {\n      className: \"collapse\",\n      id: \"Comment\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      id: \"user\",\n      className: \"form-control\",\n      placeholder: \"user\",\n      value: this.props.user.login,\n      disabled: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"md-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      id: \"form10\",\n      className: \"md-textarea form-control\",\n      rows: \"3\",\n      value: this.props.commentText,\n      onChange: this.handleChangeField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }))))))))), React.createElement(Masonry, {\n      options: masonryOptions,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, this.props.comments.map(comment => React.createElement(Comment, {\n      key: comment.id || '',\n      title: comment.owner,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }, comment.text))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    article: state.article.data,\n    error: state.comment.message,\n    commentText: state.comment.commentText,\n    isDisabled: state.comment.isDisabled,\n    user: state.app.user,\n    comments: state.comment.comments\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    getArticle: (token, id) => dispatch(getArticle(token, id)),\n    updateField: value => dispatch(updateField(value)),\n    updateDisabled: isDisabled => dispatch(updateDisabled(isDisabled)),\n    createComment: (url, token, comment) => dispatch(createComment(url, token, comment)),\n    getComments: (url, token) => dispatch(getComments(url, token)),\n    updateComment: comment => dispatch(updateComment(comment))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withNoUser(ArticleCommetns));","map":{"version":3,"sources":["/media/user/HDD/taskList/client/src/components/ArticleComments.js"],"names":["React","route","withNoUser","connect","func","Header","getArticle","token","Masonry","updateField","updateDisabled","createComment","getComments","updateComment","urls","Comment","io","ArticleCommetns","Component","constructor","props","handleChangeField","bind","handleCreateComment","handleBack","location","search","length","query","queryParse","page","limit","history","push","pageArticleRouteSort","sort","by","pageArticleRouteLimit","pageArticleLimitRouteWithSort","pageArticleRoute","pageArticleRouteWithSort","ARTICLE_LIST","gettedToken","getToken","comment","id","match","params","text","commentText","creator","user","URL_COMMENT","error","isInvalidToken","logout","SIGN_IN","console","log","event","target","value","componentDidMount","socket","URL_ROOT","emit","on","id_article","urlArticleComments","render","masonryOptions","itemSelector","breakpointCols","columnWidth","gutter","isFitWidth","isError","viewError","color","float","article","title","body","dateCreated","dateUpdated","isDisabled","login","comments","map","owner","mapStateToProps","state","data","message","app","mapDispatchToProps","dispatch","url"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as route from '../constants/routes';\nimport withNoUser from './withNoUser';\nimport { connect } from 'react-redux';\nimport * as func from '../functions/functions';\nimport Header from './Header';\nimport {getArticle} from '../redux/actions/ArticleActions';\nimport {token} from './Token';\nimport Masonry from 'react-masonry-component';\nimport {updateField, updateDisabled,createComment, getComments, updateComment} from '../redux/actions/CommentActions';\nimport * as urls from '../constants/urls';\nimport Comment from './Comment';\nimport io from 'socket.io-client';\n\n\nclass ArticleCommetns extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.handleChangeField = this.handleChangeField.bind(this);\n        this.handleCreateComment = this.handleCreateComment.bind(this);\n        this.handleBack = this.handleBack.bind(this);\n    }\n\n    handleBack() {\n        if(this.props.location.search.length){ \n            const query = func.queryParse(this.props.location.search);\n            if(!query.page){\n                if(!query.limit) {\n                    this.props.history.push(route.pageArticleRouteSort(query.sort, query.by))\n                } else {\n                    if(!query.sort) {\n                        this.props.history.push(route.pageArticleRouteLimit(query.limit))\n                    } else {\n                        this.props.history.push(route.pageArticleLimitRouteWithSort(query.limit, query.sort, query.by))\n                    }\n                }\n            } else {\n                if(!query.sort) {\n                    this.props.history.push(route.pageArticleRoute(query.page,query.limit))\n                } else {\n                    this.props.history.push(route.pageArticleRouteWithSort(query.page, query.limit, query.sort, query.by))\n                }\n            } \n        } else {\n            this.props.history.push(route.ARTICLE_LIST);\n        } \n    }\n\n    async handleCreateComment() {\n        try {\n            const gettedToken = token.getToken();\n            const comment = {\n                id: this.props.match.params.id,\n                text: this.props.commentText,\n                creator: this.props.user.id\n            }\n            await this.props.createComment(urls.URL_COMMENT, gettedToken, comment);\n            this.props.updateDisabled(true);\n        } catch (error) {\n            if(error.isInvalidToken){\n                token.logout();\n                this.props.history.push(route.SIGN_IN);\n            } else {\n                console.log(error);\n            }\n        }\n    }\n\n    handleChangeField(event) {\n        this.props.updateDisabled(false);\n        this.props.updateField(event.target.value);\n    }\n\n    async componentDidMount() {\n        try {\n            const socket = io(urls.URL_ROOT);\n            const gettedToken = token.getToken();\n            socket.emit('auth', {id: this.props.user.id})\n            \n            socket.on('getNewComment', (comment) => {\n                if(this.props.match.params.id === comment.id_article) {\n                    this.props.updateComment(comment)\n                }\n            })\n            await this.props.getArticle(gettedToken, this.props.match.params.id);\n            await this.props.getComments(urls.urlArticleComments(this.props.match.params.id), gettedToken);\n            this.props.updateDisabled(true);\n        } catch (error) {\n            if(error.isInvalidToken){\n                token.logout();\n                this.props.history.push(route.SIGN_IN);\n            } else {\n                console.log(error);\n            }\n        }\n    }\n\n    render() {\n\n        const masonryOptions = {\n            itemSelector: '.grid-item',\n            breakpointCols: 3,\n            columnWidth: 300,\n            gutter: 10,\n            isFitWidth: true\n        };\n\n        const isError = !!this.props.error;\n        const viewError = isError ? <h6 style={{color: 'red'}}>{this.props.error}</h6> : null;\n\n        return (\n            <div>\n                <Header/>\n                <button className=\"btn btn-outline-dark\" type=\"button\" onClick={this.handleBack} style={{float:'right'}}>Back</button>\n                <div className=\"container\">\n                    <div className=\"row\">\n                        <div className=\"col-sm-9 col-md-7 col-lg-5 mx-auto\">\n                            <div className=\"card card-signin my-5\">\n                                <div className=\"card-body\">\n                                    <h5 className=\"card-title text-center\">CommentArticle</h5>\n                                    <form className=\"form-signin\">\n                                        <div className=\"form-label-group\">\n                                            <label htmlFor=\"inputTitle\">Title</label>\n                                            <input type=\"text\" id=\"inputTitle\" className=\"form-control\" placeholder=\"title\" name=\"title\" value={this.props.article.title} disabled/>\n                                        </div>\n                                        <br/>\n        \n                                        <div className=\"form-label-group\">\n                                            <label htmlFor=\"inputBody\">Body</label>\n                                            <input type=\"text\" id=\"inputBody\" className=\"form-control\" placeholder=\"body\" name=\"body\" value={this.props.article.body} disabled/>\n                                        </div>\n                                        <br/>\n        \n                                        <div className=\"form-label-group\">\n                                            <label htmlFor=\"inputDateCreated\">DateCreated</label>\n                                            <input type=\"text\" id=\"inputDateCreated\" className=\"form-control\" placeholder=\"dateCreated\" name=\"dateCreated\" value={this.props.article.dateCreated} disabled/>\n                                        </div>\n                                        <br/>\n\n                                        <div className=\"form-label-group\">\n                                            <label htmlFor=\"inputDateUpdated\">DateUpdated</label>\n                                            <input type=\"text\" id=\"inputDateUpdated\" className=\"form-control\" placeholder=\"dateUpdated\" name=\"dateUpdated\" value={this.props.article.dateUpdated} disabled/>\n                                        </div>\n                                        <br/>\n                                        {viewError}\n                                        <br/>\n                                        <hr className=\"my-4\"></hr>\n                                        <p>\n                                            <button className=\"btn btn-outline-info\" type=\"button\" data-toggle=\"collapse\" data-target=\"#Comment\" aria-expanded=\"false\" aria-controls=\"Comment\">\n                                                Comment\n                                            </button>\n                                            <button className=\"btn btn-outline-success\" type=\"button\" style={{float:'right'}} data-toggle=\"collapse\"\n                                                    data-target=\"#Comment\" aria-expanded=\"false\" aria-controls=\"Comment\" disabled={this.props.isDisabled} onClick={this.handleCreateComment}>\n                                                AddComment\n                                            </button>\n                                        </p>\n                                        <div className=\"collapse\" id=\"Comment\">\n                                            <input type=\"text\" id=\"user\" className=\"form-control\" placeholder=\"user\" value={this.props.user.login} disabled/>\n                                            <div className=\"md-form\">\n                                                <textarea id=\"form10\" className=\"md-textarea form-control\" rows=\"3\" value={this.props.commentText} onChange={this.handleChangeField}></textarea>\n                                            </div>\n                                        </div>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <Masonry\n                options={masonryOptions}\n                >\n                        {\n                            this.props.comments.map((comment) => (\n                                <Comment\n                                    key={comment.id || ''}\n                                    title={comment.owner}\n                                >\n                                    {comment.text}\n                                </Comment>\n                            ))\n                        }\n                </Masonry>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        article: state.article.data,\n        error: state.comment.message,\n        commentText: state.comment.commentText,\n        isDisabled: state.comment.isDisabled,\n        user: state.app.user,\n        comments: state.comment.comments\n    }\n};\n  \nconst mapDispatchToProps = (dispatch) => {\n    return {\n        getArticle: (token, id) => dispatch(getArticle(token, id)),\n        updateField: (value) => dispatch(updateField(value)),\n        updateDisabled: (isDisabled) => dispatch(updateDisabled(isDisabled)),\n        createComment: (url, token, comment) => dispatch(createComment(url, token, comment)),\n        getComments: (url, token) => dispatch(getComments(url, token)),\n        updateComment: (comment) => dispatch(updateComment(comment))\n    }\n};\n\n  \nexport default connect(mapStateToProps, mapDispatchToProps)(withNoUser(ArticleCommetns));"]},"metadata":{},"sourceType":"module"}